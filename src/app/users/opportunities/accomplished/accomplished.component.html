<div class="content">
  <div style="max-height: 500px; overflow: hidden" class="px-2">
    <div *ngIf="volunteerRegistrations.length == 0">
      <p class="bold">Você ainda não realizou nenhum evento</p>
    </div>

    <div *ngIf="volunteerRegistrations.length > 0">
      <h2 class="bold">Oportunidades</h2>

      <table class="table">
        <thead>
          <tr>
            <th class="col">Instituição</th>
            <th class="col">Oportunidade</th>
            <th class="col">Data</th>
            <th class="col">Certificado</th>
            <th class="col">Relatar Problema</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let volunteerRegistration of volunteerRegistrations">
            <td>
              {{ volunteerRegistration.opportunity.institution.name }}
            </td>
            <td>
              {{ volunteerRegistration.opportunity.name }}
            </td>
            <td>
              {{
                volunteerRegistration.opportunity.opportunityDate
                  | date : "shortDate"
              }}
            </td>
            <td>
              <button
                class="btn btn-sm btn-outline-primary"
                title="Mostrar Certificado"
                (click)="
                  openCertificate(volunteerRegistration, certificateModal)
                "
              >
                <span class="bi bi-card-text"></span>
              </button>
            </td>
            <td>
              <button
                class="btn btn-sm btn-outline-danger"
                title="Relatar Problema"
                (click)="openIssue(volunteerRegistration, problemModal)"
              >
                <span class="bi bi-exclamation-circle"></span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<ng-template #certificateModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Certificado</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div
    class="modal-body certificate w-100 d-flex justify-content-start align-items-center flex-column text-center"
  >
    <div style="height: 20vh"></div>

    <h4>Certificado de Participação</h4>

    <div class="row d-flex justify-content-center">
      <div class="col-8 mt-4">
        <p class="m-0">
          Certificamos que {{ currentCandidate.name }} participou da
          oportunidade

          <strong>{{
            certificateVolunteerRegistration.opportunity.name
          }}</strong>
          realizado pela
          <strong>{{
            certificateVolunteerRegistration.opportunity.institution.name
          }}</strong>

          no dia
          <strong>{{
            certificateVolunteerRegistration.opportunity.opportunityDate
              | date : "longDate"
          }}</strong
          >, contribuindo para uma sociedade melhor.
        </p>

        <div
          class="d-flex flex-column align-items-center mt-4"
          *ngIf="
            certificateVolunteerRegistration.opportunity.causes?.length > 0
          "
        >
          <h6>Causas Defendidas</h6>

          <ul>
            <li
              *ngFor="
                let cause of certificateVolunteerRegistration.opportunity.causes
              "
            >
              {{ cause }}
            </li>
          </ul>
        </div>

        <div class="mt-4">
          <p class="m-0">{{ currentDate | date : "longDate" }}</p>
        </div>
      </div>
    </div>
    <!-- <form>
			<div class="mb-3">
				<label for="dateOfBirth">Date of birth</label>
				<div class="input-group">
					<input
						id="dateOfBirth"
						class="form-control"
						placeholder="yyyy-mm-dd"
						name="dp"
						ngbDatepicker
						#dp="ngbDatepicker"
					/>
					<button class="btn btn-outline-secondary bi bi-calendar3" (click)="dp.toggle()" type="button"></button>
				</div>
			</div>
		</form> -->
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-outline-dark"
      (click)="modal.close('Save click')"
    >
      Salvar
    </button>
  </div>
</ng-template>

<ng-template #problemModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title2">Relatar Problema</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <div class="mb-3">
      <form [formGroup]="instituionProblemForm">
        <label for="message" class="form-label">O que aconteceu?</label>
        <textarea
          class="form-control"
          formControlName="message"
          id="message"
          rows="5"
          cols="5"
        ></textarea>
      </form>
    </div>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-outline-dark"
      (click)="saveIssue(modal)"
    >
      Enviar
    </button>
  </div>
</ng-template>
